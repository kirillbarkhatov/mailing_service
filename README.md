# Веб-приложение для рассылки сообщений

## Описание:

Это веб-приложение, разработанное на Django, которое позволяет пользователям управлять рассылками сообщений для клиентов. Приложение включает функциональность для создания, просмотра, редактирования и удаления рассылок, а также отправки сообщений по требованию.

## Установка, настройка и запуск:

Ссылка для добавления проекта:
[git@github.com:kirillbarkhatov/mailing_service.git]()

Для создания виртуального окружения и установки зависимостей используйте `Poetry`. `poetry install` - установите все зависимости

Из шаблона `.env.sample` создайте файл `.env`

### НАСТРОЙКИ `.env`
### DJANGO

Укажите ваш ключ джанго

`SECRET_KEY=`

Укажите режим работы `True` или `False`

`DEBUG=`

### БД

Для проекта используется `PostgreSQL`. Настройте ваши параметры, предварительно, при необходимости, создав пустую БД

`NAME=`

`USER=`

`PASSWORD=`

`HOST=`

`PORT=`

Для тестирования можно использовать фикстуры - заполните БД тестовыми данными, используя команду `python3 manage.py add_test_data` и `python3 manage.py csu`.

### Почта

Внесите учетные данные в `.env`.

Используйте отдельный пароль для приложений, который создаётся в настройках безопасности учетной записи почтового сервиса.

Первые 4 поля - пример настроек для `mail.ru`

`EMAIL_HOST=smtp.mail.ru`

`EMAIL_PORT=465`

`EMAIL_USE_SSL=True`

`EMAIL_USE_TLS=False`

`EMAIL_HOST_USER=`

`EMAIL_HOST_PASSWORD=`

### Кеширование

Используйте `redis` Внесите настройки в `.env`.

Пример настроек с локальным сервером кеширования:

`CACHE_ENABLED=True`

`LOCATION=redis://127.0.0.1:6379/1`

### Запуск проекта

Примените миграции `python3 manage.py migrate`.

Создайте суперпользователя `python3 manage.py csu`.

Подгрузите тестовые данные `python3 manage.py add_test_data`

Запустите сервер кеширования `redis-server`

Запустите локальный HTTP-сервер командой `python3 manage.py runserver`.

Запустите задачу периодической рассылки `python3 manage.py runapscheduler`.

Зайдите в браузере по ссылке [127.0.0.1:8000]() - проверьте работоспособность.

## Использование:


1. Инициация отправки.

Попытка рассылки создается каждый раз, когда запускается процесс отправки сообщений для конкретной рассылки.
2. Определение получателей.

Список клиентов, которым должно быть отправлено сообщение, определяется из выбранных клиентов для данной рассылки.
3. Отправка сообщения:

Для каждого клиента из списка выполняется отправка письма.
В случае успешной отправки письма создается запись со статусом «успешно».
В случае ошибки отправки, например из-за недоступности почтового сервера, создается запись со статусом «не успешно» и текстом ошибки в поле «Ответ почтового сервера».
4. Сбор статистики.

Каждая попытка отправки письма фиксируется, что позволяет отслеживать успешные и неуспешные попытки, а также общее количество попыток.
5. Анализ и отчетность.

Данные о попытках рассылок используются для формирования статистики и отчетности, предоставляя пользователю информацию о статусе и результатах его рассылок.


## Функционал

- Управление клиентами: возможность добавлять, просматривать, редактировать и удалять получателей рассылки (клиентов).
- Управление сообщениями: возможность добавлять, просматривать, редактировать и удалять сообщения.
- Управление рассылками: возможность добавлять, просматривать, редактировать и удалять рассылки с различными статусами.
- Отправка сообщений по требованию: реализация функции отправки рассылки вручную.
- Попытки рассылок: логирование каждой попытки отправки сообщения с сохранением статуса и ответа почтового сервера.
- Главная страница: отображение статистики по всем рассылкам и получателям.
- Автоматическая рассылка и её логгирование

## Описание ролей и прав доступа:
* Пользователи могут управлять только своими рассылками и клиентами.
* Менеджеры могут просматривать все рассылки и клиентов, но не могут редактировать или удалять чужие данные.
#### Пользователь
* Создание, просмотр, редактирование и удаление своих клиентов и рассылок.
* Просмотр статистики по своим рассылкам.
#### Менеджер
* Просмотр всех клиентов и рассылок.
* Просмотр списка пользователей сервиса.
* Блокировка пользователей сервиса.
* Отключение рассылок.


## Лицензия:

Этот проект лицензирован по [лицензии MIT](LICENSE).